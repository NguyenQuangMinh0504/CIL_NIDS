2023-10-25 14:18:26,211 [trainer.py] => Time Str >>> 1025-14-18-26-210
2023-10-25 14:18:26,212 [trainer.py] => memory_per_class: 20
2023-10-25 14:18:26,212 [trainer.py] => fixed_memory: False
2023-10-25 14:18:26,212 [trainer.py] => shuffle: True
2023-10-25 14:18:26,212 [trainer.py] => model_name: memo
2023-10-25 14:18:26,212 [trainer.py] => seed: 1993
2023-10-25 14:18:26,212 [trainer.py] => dataset: cifar100
2023-10-25 14:18:26,212 [trainer.py] => init_cls: 5
2023-10-25 14:18:26,212 [trainer.py] => increment: 5
2023-10-25 14:18:26,212 [trainer.py] => convnet_type: memo_resnet32
2023-10-25 14:18:26,212 [trainer.py] => prefix: benchmark
2023-10-25 14:18:26,212 [trainer.py] => device: [device(type='cpu')]
2023-10-25 14:18:26,212 [trainer.py] => debug: False
2023-10-25 14:18:26,212 [trainer.py] => skip: False
2023-10-25 14:18:26,212 [trainer.py] => train_base: False
2023-10-25 14:18:26,212 [trainer.py] => train_adaptive: False
2023-10-25 14:18:26,212 [trainer.py] => scheduler: steplr
2023-10-25 14:18:26,212 [trainer.py] => t_max: None
2023-10-25 14:18:26,212 [trainer.py] => epochs: 170
2023-10-25 14:18:26,212 [trainer.py] => milestones: [80, 120, 150]
2023-10-25 14:18:26,212 [trainer.py] => lrate_decay: 0.1
2023-10-25 14:18:26,212 [trainer.py] => batch_size: 128
2023-10-25 14:18:26,212 [trainer.py] => lrate: 0.1
2023-10-25 14:18:26,212 [trainer.py] => weight_decay: 0.0002
2023-10-25 14:18:26,212 [trainer.py] => alpha_aux: 1.0
2023-10-25 14:18:26,212 [trainer.py] => config: ./exps/memo.json
2023-10-25 14:18:26,212 [trainer.py] => time_str: 1025-14-18-26-210
2023-10-25 14:18:26,212 [trainer.py] => exp_name: 1025-14-18-26-210_cifar100_memo_resnet32_1993_B0_Inc5
2023-10-25 14:18:26,213 [trainer.py] => logfilename: logs/benchmark/cifar100/memo/1025-14-18-26-210_cifar100_memo_resnet32_1993_B0_Inc5
2023-10-25 14:18:26,213 [trainer.py] => csv_name: cifar100_1993_memo_resnet32_B0_Inc5
2023-10-25 14:18:28,856 [memo_cifar_resnet.py] => Layer block is: 5
2023-10-25 14:18:28,871 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,872 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,872 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,872 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,873 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,873 [memo_cifar_resnet.py] => Structure of stage 1 is: Sequential(
  (0): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (1): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (2): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (3): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (4): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)
2023-10-25 14:18:28,873 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 32, strides: 2, downsample: DownsampleA(
  (avg): AvgPool2d(kernel_size=1, stride=2, padding=0)
)
2023-10-25 14:18:28,874 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,874 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,874 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,875 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,875 [memo_cifar_resnet.py] => Structure of stage 2 is: Sequential(
  (0): ResnetBasicblock(
    (conv_a): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (downsample): DownsampleA(
      (avg): AvgPool2d(kernel_size=1, stride=2, padding=0)
    )
  )
  (1): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (2): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (3): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (4): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)
2023-10-25 14:18:28,879 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 64, strides: 2, downsample: DownsampleA(
  (avg): AvgPool2d(kernel_size=1, stride=2, padding=0)
)
2023-10-25 14:18:28,879 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,880 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,881 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,881 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,887 [memo.py] => >>> train generalized blocks:False train_adaptive: False
2023-10-25 14:18:28,887 [trainer.py] => Type of model is: <class 'models.memo.MEMO'>
2023-10-25 14:18:28,887 [trainer.py] => Type of model network is: <class 'utils.inc_net.AdaptiveNet'>
2023-10-25 14:18:28,887 [trainer.py] => Start time:1698218308.887648
2023-10-25 14:18:28,887 [trainer.py] => Data manager.nb_tasks is: 20
2023-10-25 14:18:28,888 [trainer.py] => All params: 107408
2023-10-25 14:18:28,888 [trainer.py] => Trainable params: 107408
2023-10-25 14:18:28,888 [memo_cifar_resnet.py] => Layer block is: 5
2023-10-25 14:18:28,888 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,888 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,889 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,889 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,889 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 16, strides: 1, downsample: None
2023-10-25 14:18:28,890 [memo_cifar_resnet.py] => Structure of stage 1 is: Sequential(
  (0): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (1): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (2): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (3): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (4): ResnetBasicblock(
    (conv_a): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)
2023-10-25 14:18:28,890 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 16; planes: 32, strides: 2, downsample: DownsampleA(
  (avg): AvgPool2d(kernel_size=1, stride=2, padding=0)
)
2023-10-25 14:18:28,891 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,891 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,891 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,892 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 32, strides: 1, downsample: None
2023-10-25 14:18:28,892 [memo_cifar_resnet.py] => Structure of stage 2 is: Sequential(
  (0): ResnetBasicblock(
    (conv_a): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (downsample): DownsampleA(
      (avg): AvgPool2d(kernel_size=1, stride=2, padding=0)
    )
  )
  (1): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (2): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (3): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (4): ResnetBasicblock(
    (conv_a): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_a): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (conv_b): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (bn_b): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)
2023-10-25 14:18:28,894 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 32; planes: 64, strides: 2, downsample: DownsampleA(
  (avg): AvgPool2d(kernel_size=1, stride=2, padding=0)
)
2023-10-25 14:18:28,895 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,896 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,897 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,898 [memo_cifar_resnet.py] => Resnet Basic block input: inplanes: 64; planes: 64, strides: 1, downsample: None
2023-10-25 14:18:28,903 [inc_net.py] => SpecializedResNet_cifar(
  (final_stage): Sequential(
    (0): ResnetBasicblock(
      (conv_a): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn_a): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv_b): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_b): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): DownsampleA(
        (avg): AvgPool2d(kernel_size=1, stride=2, padding=0)
      )
    )
    (1): ResnetBasicblock(
      (conv_a): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_a): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv_b): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_b): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (2): ResnetBasicblock(
      (conv_a): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_a): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv_b): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_b): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (3): ResnetBasicblock(
      (conv_a): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_a): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv_b): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_b): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (4): ResnetBasicblock(
      (conv_a): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_a): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv_b): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn_b): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
  )
  (avgpool): AvgPool2d(kernel_size=8, stride=8, padding=0)
)
2023-10-25 14:18:28,904 [memo.py] => Learning on 0-5
2023-10-25 14:18:28,905 [memo.py] => All params: 440464
2023-10-25 14:18:28,905 [memo.py] => Trainable params: 440464
2023-10-25 14:18:28,916 [trainer.py] => current task is: 0
